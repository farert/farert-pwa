# **<発着駅選択>** 画面

- **<発着駅選択>** 画面は、 **<メイン>** 画面の`発駅選択`をタップしてから遷移、または **<メイン>** 画面の`追加`をタップしてから遷移した **<路線選択>** 画面の``着駅選択(最短経路)`` をタップしてから遷移する2ソースより遷移する。

- **<発着駅選択>** 画面は、画面上部のタブによる切り替えで3つのビューと、画面上部のタブの下に表示された検索バーをクリックすることにより画面下部のビューを切り替える。
  - タブ
    - ``グループ``
    - ``都道府県``
    - ``履歴``
  - 検索バー
    - インクリメンタル検索

各ビューでリストされた項目は、"路線"、"駅" の2種類で、"路線"を選択した場合、さらに **<駅一覧>** 画面へ遷移する。

以下に各ビューの各 _`行`_ を選択したときの遷移画面を記す

    - ``グループ``：路線 →　駅
    - ``都道府県``：路線 →　駅
    - ``履歴``：駅
    - インクリメンタル検索：駅

最終的には _駅_ を選択して **<メイン>** 画面へ返す。

## レイアウト構成

### 1行目 画面タイトル

- センタリングでタイトル表示

- ``"発駅選択"``
- ``"着駅選択(最短経路)"``

### 2行目（タブバー）

- 左端: ``戻る``ボタン
- 中央: タブ（センタリング）
  - ``グループ`` | ``都道府県`` | ``履歴``
- 右端: ``編集``ボタン（履歴選択時のみ有効）

### 3行目（検索バー）

- 検索アイコン ``🔍``  + テキスト入力バー + ``×`` ボタンラベル(テキスト入力バーにフォーカス保持している時のみ表示)

### 4行目(リストタイトル)

タブ、検索バーに応じて内容が切り替わる

以下に例をしめす

|``グループ`` | ``都道府県`` | ``履歴``|``検索``|
|----------|-----------|------|-----|
| _JR東日本_| _埼玉_|``"履歴"``|"一致件数" : _23件_|


### 5行目以降（リスト表示エリア）

次節

## タブ別の表示内容と動作

### グループタブ

- JRグループ会社名を6行表示（例: _JR北海道_、_JR東日本_、_JR東海_、_JR西日本_、_JR四国_、_JR九州_）
- 選択 → **路線一覧**表示 →  **<駅一覧>** 表示
- _`駅`_ 選択 → **<メイン>** 画面へ戻る

### 都道府県タブ

- 都道府県を46行表示（沖縄を除く）（例: _北海道_、_青森_、_岩手_、...）
- 選択 → **路線一覧**表示 →  **<駅一覧>** 表示
- _`駅`_ 選択 → **<メイン>** 画面へ戻る

### 履歴タブ

- 履歴に保存されている過去に選択した _`駅`_ を最近順に表示
- webストレージに保存されているものを読み込む
- _`駅`_ 選択 → **<メイン>** 画面へ戻る

#### 履歴の編集モード

``編集``をタップ時:

- 駅一覧の左端に ``⛔️``（侵入禁止マーク）アイコン表示
- アイコンタップで削除可能
- **画面最下部**:
  - ``クリア``ボタン: 全消去
  - ``Undo``アイコン: 削除の取り消し

## 検索機能

### 検索バークリック時の動作

1. 検索バーが1行目に移動
2. 右端に ``✖️`` アイコンが表示される
3. 検索文字を入力すると駅が絞り込まれる
4. 「リストタイトル」として、一致件数と一致した駅一覧を表示

### 検索結果の表示形式

```
_駅名_
_ひらがな_ (_都道府県_)
```

 例
```
東京
とうきょう(東京都)
```

- 1行目は通常文字で、2行目の文字は70%ほど小さく

### 検索からの選択

- _`駅`_ 選択 → **<メイン>** 画面へ戻る
- ✖️をタップ → タブ表示に戻る


## データソース

- WASM
  - 都道府県の列挙
    - `wasm.getPrefects():string[]`
  - JRグループの列挙
    - `wasm.getJRGroups():string[]`
  - ひらがな
    - `wasm.getKanaByStation(stationName: string):string`
  - 駅のある都道府県
    - `wasm.getPrefectureByStation(stationName: string): string`
  - 路線の会社管轄内駅一覧を返す
    - `wasm.getStationsByCompanyAndLine(jrgroup: string, lineName: string) : string[]`
  - 路線の都道府県内の駅一覧を返す
    - `wasm.getStationsByPrefectureAndLine(company : string, line : string):string []`
  - 検索
    - `wasm.searchStationByKeyword(matchStation: string): string[]`

- 履歴検索
  - listLinesFromHistoryStorage():string[]
- 開発時は仮のスタブを利用
