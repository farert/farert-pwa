# **<メイン>** 画面の詳細仕様

- **<メイン>** 画面は、初期表示の画面で、経路オブジェクトを1つもつ
- 経路は初期状態では空
- Webストレージに保存し、PWAで他アプリへ行く際は保存する
- 経路は、カンマまたはスペースで区切られた、駅,路線の連続した文字列である。その並びは
   駅1 路線1 駅2 路線2　駅3 路線3 駅4 ...
  と奇数個のフィールドで並ぶ. これを縦に並べると、駅1のみ発駅として独立し、以降は、路線 着駅 の繰り返しとなる。

## ヘッダー部

- ハンバーガーメニュー | タイトル | 3点メニュー
- ハンバーガーメニュー: きっぷホルダドロワーを開く
- 3点メニュー: オプションメニューを表示
  - バージョン情報
  - （その他の項目）

## リスト表示部（0〜N行）

### 行の構成

1. 1行目:  ``[発駅表示]`` （例: _東京_）
2. 2〜N-2行目: 路線と着駅（2行1組）（例: _[東海道線]_ _熱海_）
3. N-1行目: ``[追加]``ラベル
4. N行目（最終行）: 営業キロ、普通運賃、有効日数（例: _130.0km ¥2,310 2日_）

### 初期状態

- 1行目: ``[発駅を指定してください]``のみ表示

### 発駅指定時の動作

1. **<発着駅選択>** 画面を表示
2. 選択後、1行目が ``[発駅表示]`` に変更（例: _東京_）
3. 2行目に``[追加]``が表示される

### 経路追加時の動作

- 経路追加は、**<発駅選択>** 後、「路線、着駅」を得るため、**<路線選択>**画面 -> **<駅選択>** 画面へ遷移し、路線、着駅を選択後にメイン画面の経路を追加してゆく動作を指す。

1. **<路線選択>** 画面 → **<駅選択>** 画面(分岐駅選択)の順で表示
2. 選択後、2行目以降に路線・着駅が追加される（例: _[東海道線]_ _熱海_）
3. N-1行目が``[追加]``、N行目が営業キロ等の表示となる（例: _130.0km ¥2,310 2日_）
4. 最終駅まで追加可能（経路オブジェクトが最終駅判定を返す）
5. 画面がいっぱいになっても``[追加]``が隠れないようスクロール

## 行のタップ動作

### 1行目（発駅）

- ``[発駅選択]`` 画面 を表示
- 選択時、既存の経路行を全削除し、1行目（``[発駅]``）+ 2行目（``[追加]``）の2行表示に戻る

### N-1行目（追加）

- (2行以上の時：経路数1以上の時)
- **<路線選択>** 画面 → **<経路追加>**
- 経路2以上のときは、**<経路追加>**

### 2〜N-2行目（路線・着駅）

- (3行以上の時：経路数2以上の時)
- タップした行を着駅とした **<詳細>** 画面へ遷移
- 経路データを圧縮してURLパラメータで渡す（`/detail?r={compressed}`）

### N行目（最終行・前経路の結果詳細）

- (3行以上の時：経路数2以上の時)
- N-2行目と同じ動作、全経路の **<詳細>** 画面へ遷移
- 全経路データを圧縮してURLパラメータで渡す（`/detail?r={compressed}`）

## フッター部（画面下部・1行）

左から順にアイコン配置:

1. ``[↩︎戻る]``: 初期状態はグレーアウト。経路1つ以上かつ発駅がある場合に有効
2. ``[反転]``: 初期状態はグレーアウト。経路2つ以上かつ発駅・路線着駅がある場合に有効
3. ``[オプション]``: グレーアウトで無効
4. ``[📁ファイルフォルダ]``: 常に有効

スクリーンショットには「オプション」は、右上のハンバーガーメニュー内にあるが、ここに持ってくる。オプションは「大阪環状線遠回り・近回り」がある。

動作は、

1. ``[↩︎戻る]``: 経路を-1する（最後の経路を削除し）経路を再表示する
2. ``[反転]``: 経路を反転して再表示する（逆順に並べ替える）
3. ``[オプション]``: メニューを表示する。選択すると経路を計算しなおす
4. ``[📁ファイルフォルダ]``: **<保存>** 画面へ遷移する 引数は経路 ``route`` でカンマで区切った経路で最大10KB?最長経路の文字数 

## データソース

- 運賃計算
  - `wasm.getFareInfoObjectJson() : FareInfo`
