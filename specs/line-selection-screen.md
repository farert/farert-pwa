# **<路線選択>** 画面の詳細仕様

**<路線選択>** 画面は **<発着駅選択>** 画面のビューからの遷移と、 **<メイン>**画面の`追加`による**経路追加**からの遷移する

## 呼び出し画面

2箇所から呼ばれる。遷移元は2ページ

- **<発着駅選択>** 画面
  - ``グループ``
  - ``都道府県``
- **<メイン>** 画面 
  - ``[追加]``

## 入力パラメーター

入力引数は、以下のパターンで、ソース画面より遷移する

|ソース画面|パラメーター|パラメーター2|パラメーター3|
|----|-----|-----|-----|
|**<メイン>** ``[追加]``|``from=main``|``station``=_xxxx_||
|**<メイン>** ``[追加]``|``from=main``|``station``=_xxxx_|``line``=_yyyy_|
|**<発着駅選択>**|``from=start``|``prefecture``=_aaaa_|
|**<発着駅選択>**|``from=destination``|``prefecture``=_aaaa_|
|**<発着駅選択>**|``from=start``|``group``=_aaaa_|
|**<発着駅選択>**|``from=destination``|``group``=_aaaa_|

## レイアウト

### 1行目　画面タイトル

- 左端: ``[戻る]``
- 中央: タイトル "路線"
- 右端: ``[最短経路]``
  - ``from=main`` のときのみ、右端の``[最短経路]``ボタンラベルを表示する。

### 2行目: リストタイトル

以下のパラメーターが存在すれば、リストタイトルが決定される

|パラメーター|リストタイトル|
|----|-----|
|``station``=_xxxx_|駅名を表示（例: _東京_）|
|``prefecture``=_aaaa_|都道府県名を表示（例: _東京都_）|
|``group``=_aaaa_|JRグループ名を表示（例: _JR東日本_）|

### 3行目以降: リスト

#### ``from``=main

- 駅の所属する路線名を列挙
- 入力パラメーターの ``line``と一致する路線は、反転表示して選択できないようにする。背景色はテーマカラーで良い

#### ``group`` parameter is not null

- JRグループに属する路線名を列挙（例: _東海道線_、_中央線_、_山手線_、...）

#### ``prefecture`` parameter is not null

- 都道府県に属する路線名を列挙（例: _東海道線_、_中央線_、_京浜東北線_、...）

## 動作

### 路線選択の _`行`_ を選択

- **<駅選択>** 画面へ遷移
- **<駅選択>** 画面への引数は以下の通り

|パラメーター|パラメーター2|パラメーター3|
|-----|-----|-----|
|``from=main``|``station``=_xxxx_|``line``=_yyyy_|
|``from=start``</br>``from=destination``|``line``=_xxxx_|``prefecture``=_aaaa_|
|``from=start``</br>``from=destination``|``line``=_xxxx_|``group``=_aaaa_|

- ``line`` は本画面 **<路線選択>** 画面で選択した路線

### ボタンラベル ``[最短経路]``をタップ

- **<発着駅選択>** 画面へ遷移する。
  - <発着駅選択> の画面と動作は [terminal-selection-screen.md](terminal-selection-screen.md) の動作とおなじ。画面タイトルは「着駅選択（最短経路）」となり、駅選択後、メイン画面へ遷移し、`wasm.autoRoute()`を実行し、経路画面を反映する。
  - 入力パラメーターはなし

---

## データソース

- 駅の所属路線を配列で返す
  - `wasm.getLinesByStation(station: string):string[]`
- 都道府県の路線一覧を配列で返す
  - `wasm.getLinesByPrefecture(prefecture: string):string[]`
- JRグループの路線一覧を配列で返す
  - `wasm.getLinesByCompany(jrgroup: string):string[]`
